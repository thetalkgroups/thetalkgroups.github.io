var EventEmitter=function(){function e(){this.nextId=0,this.subscribers=[]}return e.prototype.subscribe=function(e){var t=this,n=this.nextId;return this.nextId+=1,void 0!==this.value&&e(this.value),this.subscribers.push({id:n,func:e}),function(){t.subscribers=t.subscribers.filter(function(e){var t=e.id;return t!==n})}},e.prototype.next=function(e){var t=this;this.value=e,this.subscribers.forEach(function(e){var n=e.func;return n(t.value)})},e}(),config={apiKey:"AIzaSyAjSDRU_Sl8DbTftnDghDsZJsxlAEvQpxE",authDomain:"fir-auth-test-fe62c.firebaseapp.com",databaseURL:"https://fir-auth-test-fe62c.firebaseio.com"},providers={google:new firebase.auth.GoogleAuthProvider,twitter:new firebase.auth.TwitterAuthProvider,facebook:new firebase.auth.FacebookAuthProvider};firebase.initializeApp(config);var UserService=function(){function e(){var e=this;this.user=new EventEmitter,Object.keys(localStorage).find(function(e){return e.startsWith("firebase")})||this.user.next(null),firebase.auth().onAuthStateChanged(function(t){var n=t.displayName,r=t.photoURL,i=t.email,o=t.uid;return e.user.next({id:o,name:n,photo:r,email:i})})}return e.prototype.signIn=function(e){return firebase.auth().signInWithPopup(providers[e])},e.prototype.signOut=function(){return this.user.next(null),firebase.auth().signOut()},e}(),clearItemsFromCahce=function(){return Object.keys(localStorage).filter(function(e){return e.startsWith("/item")}).forEach(function(e){return localStorage.removeItem(e)})},userService=new UserService,isParentOf=function(e,t){return"HTML"!==e.nodeName&&(!!e.matches(t)||isParentOf(e.parentNode,t))};"serviceWorker"in navigator?navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).then(function(e){console.log("service worker registered"),e.onupdatefound=function(){console.log("new service worker found")}}):console.log("service worker is not supported :-("),window.addEventListener("load",function(){var e=document.querySelector(".navigation"),t=document.querySelector(".header"),n=document.querySelector(".breadcrumb"),r=document.querySelector(".wrapper"),i=document.querySelector(".header__top-bar__open-nav-button"),o=document.querySelector(".navigation__close-nav-button"),u=document.querySelector(".header__top-bar__user-name"),c=document.querySelector(".header__top-bar__sign-in-button"),s=document.querySelector(".header__user"),a=document.querySelector(".header__user__name"),d=document.querySelector(".header__user__email"),l=document.querySelector(".header__user__photo"),f=document.querySelector(".header__user__sign-out-button");c.hidden=!1;var v=function(){e.classList.add("open"),setTimeout(function(){return document.addEventListener("click",h)})},h=function(e){var t=e.target;isParentOf(t,".navigation")||m()},m=function(){e.classList.remove("open"),document.removeEventListener("click",h)},b=72,g=n||r,p=16,_=function(){var e=document.body.getBoundingClientRect().right*headerImageHWRatio,n=e-b,r=window.scrollY;r>n?(t.style.top=-n+"px",g.style.marginTop=e+p+"px",t.classList.add("small")):(g.removeAttribute("style"),t.classList.remove("small"))},y=function(e){e?(c.hidden=!0,u.hidden=!1,s.classList.remove("not-signed-in"),u.innerText=e.name,a.innerText=e.name,d.innerText=e.email,l.src=e.photo):(c.hidden=!1,u.hidden=!0,s.classList.add("not-signed-in"))},S=!0,k=function(){s.hidden=!1,S&&(setTimeout(function(){return document.addEventListener("click",w)}),S=!1)},w=function(e){e.preventDefault(),isParentOf(e.target,".header__user")||(S=!0,s.hidden=!0,document.removeEventListener("click",w))},L=function(){clearItemsFromCahce(),w({target:document.body,preventDefault:function(){return null}}),userService.signOut()};userService.user.subscribe(y),window.addEventListener("scroll",_),i.addEventListener("click",v),o.addEventListener("click",m),f.addEventListener("click",L),u.addEventListener("click",k)}),window.addEventListener("load",function(){var e=document.querySelector(".sign-in__button.google"),t=document.querySelector(".sign-in__button.facebook"),n=document.querySelector(".sign-in__button.twitter"),r=function(e){clearItemsFromCahce(),userService.signIn(e).then(function(){return history.back()})};e.addEventListener("click",function(){return r("google")}),t.addEventListener("click",function(){return r("facebook")}),n.addEventListener("click",function(){return r("twitter")})});