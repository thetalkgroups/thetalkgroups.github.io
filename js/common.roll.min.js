var EventEmitter=function(){function e(){this.nextId=0;this.subscribers=[]}e.prototype.subscribe=function(e){var r=this;var t=this.nextId;this.nextId+=1;if(this.value!==undefined){e(this.value)}this.subscribers.push({id:t,func:e});return function(){r.subscribers=r.subscribers.filter(function(e){var r=e.id;return r!==t})}};e.prototype.next=function(e){var r=this;this.value=e;this.subscribers.forEach(function(e){var t=e.func;return t(r.value)})};return e}();var config={apiKey:"AIzaSyAjSDRU_Sl8DbTftnDghDsZJsxlAEvQpxE",authDomain:"fir-auth-test-fe62c.firebaseapp.com",databaseURL:"https://fir-auth-test-fe62c.firebaseio.com"};var providers={google:new firebase.auth.GoogleAuthProvider,twitter:new firebase.auth.TwitterAuthProvider,facebook:new firebase.auth.FacebookAuthProvider};firebase.initializeApp(config);var UserService=function(){function e(){var e=this;this.user=new EventEmitter;if(!Object.keys(localStorage).find(function(e){return e.startsWith("firebase")})){this.user.next(null)}firebase.auth().onAuthStateChanged(function(r){var t=r.displayName,n=r.photoURL,i=r.email,a=r.uid;return e.user.next({id:a,name:t,photo:n,email:i})})}e.prototype.signIn=function(e){return firebase.auth().signInWithPopup(providers[e])};e.prototype.signOut=function(){this.user.next(null);return firebase.auth().signOut()};return e}();var clearItemsFromCahce=function(){return Object.keys(localStorage).filter(function(e){return e.startsWith("/item")}).forEach(function(e){return localStorage.removeItem(e)})};var userService=new UserService;var isParentOf=function(e,r){if(e.nodeName==="HTML")return false;if(e.matches(r))return true;return isParentOf(e.parentNode,r)};if("serviceWorker"in navigator){navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).then(function(e){console.log("service worker registered :)");e.update()})}else{console.log("service worker is not supported :-(")}window.addEventListener("load",function(){var e=document.querySelector(".navigation");var r=document.querySelector(".header");var t=document.querySelector(".breadcrumb");var n=document.querySelector(".wrapper");var i=document.querySelector(".header__top-bar__open-nav-button");var a=document.querySelector(".navigation__close-nav-button");var o=document.querySelector(".header__top-bar__user-name");var s=document.querySelector(".header__top-bar__sign-in-button");var u=document.querySelector(".header__user");var c=document.querySelector(".header__user__name");var d=document.querySelector(".header__user__email");var v=document.querySelector(".header__user__photo");var l=document.querySelector(".header__user__sign-out-button");s.hidden=false;var f=function(){e.classList.add("open");setTimeout(function(){return document.addEventListener("click",h)})};var h=function(e){var r=e.target;if(isParentOf(r,".navigation"))return;m()};var m=function(){e.classList.remove("open");document.removeEventListener("click",h)};var p=72;var b=t||n;var g=16;var _=function(){var e=document.body.getBoundingClientRect().right*headerImageHWRatio;var t=e-p;var n=window.scrollY;if(n>t){r.style.top=-t+"px";b.style.marginTop=e+g+"px";r.classList.add("small")}else{b.removeAttribute("style");r.classList.remove("small")}};var y=function(e){if(!e){s.hidden=false;o.hidden=true;u.classList.add("not-signed-in")}else{s.hidden=true;o.hidden=false;u.classList.remove("not-signed-in");o.innerText=e.name;c.innerText=e.name;d.innerText=e.email;v.src=e.photo}};var S=true;var L=function(){u.hidden=false;if(S){setTimeout(function(){return document.addEventListener("click",E)});S=false}};var E=function(e){e.preventDefault();if(isParentOf(e.target,".header__user"))return;S=true;u.hidden=true;document.removeEventListener("click",E)};var k=function(){clearItemsFromCahce();E({target:document.body,preventDefault:function(){return null}});userService.signOut()};userService.user.subscribe(y);window.addEventListener("scroll",_);i.addEventListener("click",f);a.addEventListener("click",m);l.addEventListener("click",k);o.addEventListener("click",L)});